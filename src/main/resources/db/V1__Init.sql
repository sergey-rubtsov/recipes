CREATE SCHEMA IF NOT EXISTS recipes
    AUTHORIZATION "user";

CREATE TABLE IF NOT EXISTS recipes.ingredient
(
    id bigint generated by default as identity,
    category integer NOT NULL,
    name character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT ingredient_pkey PRIMARY KEY (id),
    CONSTRAINT uk_name UNIQUE (name)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS recipes.ingredient
    OWNER to "user";

CREATE TABLE IF NOT EXISTS recipes.recipe
(
    id bigint generated by default as identity,
    instructions character varying(255) COLLATE pg_catalog."default" NOT NULL,
    servings integer NOT NULL,
    title character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT recipe_pkey PRIMARY KEY (id),
    CONSTRAINT uk_title UNIQUE (title)
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS recipes.recipe
    OWNER to "user";

CREATE TABLE IF NOT EXISTS recipes.recipe_ingredients
(
    recipe_id bigint NOT NULL,
    ingredients_id bigint NOT NULL,
    CONSTRAINT fk_ingredients_id FOREIGN KEY (ingredients_id)
        REFERENCES recipes.ingredient (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fk_recipe_id FOREIGN KEY (recipe_id)
        REFERENCES recipes.recipe (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

TABLESPACE pg_default;

ALTER TABLE IF EXISTS recipes.recipe_ingredients
    OWNER to "user";

insert into recipe (id, instructions, servings, title) values (1, 'Cook the tortilla. Cooking the eggs. Finishing the tacos', 1, 'Fried Egg Taco');
insert into ingredient (id, category, name) values (1, 1, 'Egg');
insert into ingredient (id, category, name) values (2, 0, 'Taco');
insert into recipe_ingredients (recipe_id, ingredients_id) values (1, 1);
insert into recipe_ingredients (recipe_id, ingredients_id) values (1, 2);

insert into recipe (id, instructions, servings, title) values (2, 'Rinse the rice. Add the rice and water to the cooker. Cook', 1, 'Instant Pot Rice');
insert into ingredient (id, category, name) values (3, 0, 'Rice');
insert into ingredient (id, category, name) values (4, 0, 'Salt');
insert into ingredient (id, category, name) values (5, 0, 'Water');
insert into recipe_ingredients (recipe_id, ingredients_id) values (2, 3);
insert into recipe_ingredients (recipe_id, ingredients_id) values (2, 4);
insert into recipe_ingredients (recipe_id, ingredients_id) values (2, 5);

insert into recipe (id, instructions, servings, title) values (3, 'Preheat oven and roasting pan. Peel and cut sweet potatoes into wedges. Toss with oil, salt, spices. Spread out onto preheated pan. Bake', 1, 'Sweet Potato Fries');
insert into ingredient (id, category, name) values (6, 0, 'Sweet potatoes');
insert into ingredient (id, category, name) values (7, 0, 'Extra virgin olive oil');
insert into ingredient (id, category, name) values (8, 0, 'Kosher salt');
insert into ingredient (id, category, name) values (9, 0, 'Chipotle powder');
insert into recipe_ingredients (recipe_id, ingredients_id) values (3, 6);
insert into recipe_ingredients (recipe_id, ingredients_id) values (3, 7);
insert into recipe_ingredients (recipe_id, ingredients_id) values (3, 8);
insert into recipe_ingredients (recipe_id, ingredients_id) values (3, 9);